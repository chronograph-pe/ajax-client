!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function r(e,t,n,r,o,a,s){try{var i=e[a](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var s=e.apply(t,n);function i(e){r(s,o,a,i,c,"next",e)}function c(e){r(s,o,a,i,c,"throw",e)}i(void 0)}))}}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t),n.d(t,"AjaxClient",(function(){return s})),n.d(t,"AjaxClient2",(function(){return l}));var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,s,i;return t=e,(n=[{key:"getAsync",value:function(e){e.type="get",this.ajax(e)}},{key:"postAsync",value:function(e){e.type="post",this.ajax(e)}},{key:"get",value:(i=o(regeneratorRuntime.mark((function e(t){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.type="get","application/json"===t.contentType&&("String"===this.typeOf(t.data)||(n=t.data,t.data=JSON.stringify(n))),e.abrupt("return",new Promise((function(e){t.success=function(t){e({success:!0,data:t})},t.error=function(t){e({success:!1,cause:"error",error:t})},t.timeout=function(t){e({success:!1,cause:"timeout",error:t})},r.ajax(t)})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"post",value:(s=o(regeneratorRuntime.mark((function e(t){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.type="post","application/json"===t.contentType&&("String"===this.typeOf(t.data)||(n=t.data,t.data=JSON.stringify(n))),e.abrupt("return",new Promise((function(e){t.success=function(t){e({success:!0,data:t})},t.error=function(t){e({success:!1,cause:"error",error:t})},t.timeout=function(t){e({success:!1,cause:"timeout",error:t})},r.ajax(t)})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"ajax",value:function(e){var t=new XMLHttpRequest;if(!e.url)throw Error("Please specify url.");if("post"===e.type)t.open("POST",e.url,!0);else{if("get"!==e.type)throw Error("type:".concat(e.type," is not supported"));t.open("GET",e.url,!0)}if(e.dataType&&"json"===e.dataType)t.responseType="text";else{if(!e.dataType||"text"!==e.dataType)throw Error("Please check dataType:".concat(e.dataType,'. "json" or "text"  is supported as dataType now.'));t.responseType="text"}if(!e.contentType)throw Error("Please specify contentType.");try{t.setRequestHeader("Content-Type",e.contentType)}catch(t){throw Error("Invalid content type ".concat(e.contentType))}if(e.headers)for(var n in e.headers){var r=e.headers[n];t.setRequestHeader(n,r)}if(e.timeoutMillis&&(t.timeout=e.timeoutMillis),t.onload=function(n){if(200==t.status){var r="";r="json"==e.dataType?JSON.parse(t.response):t.response,e.success&&e.success(r,t)}else e.error&&e.error(n,t)},e.timeout&&(t.ontimeout=function(n){e.timeout(n,t)}),e.error&&(t.onerror=function(n){e.error(n,t)}),"post"===e.type){if(!e.data)throw Error('.data is not specified.data must be specified on "POST" mode.');t.send(e.data)}else"get"===e.type&&t.send(null)}},{key:"typeOf",value:function(e){return Object.prototype.toString.call(e).slice(8,-1)}}])&&a(t.prototype,n),r&&a(t,r),e}();function i(e,t,n,r,o,a,s){try{var i=e[a](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){i(a,r,o,s,c,"next",e)}function c(e){i(a,r,o,s,c,"throw",e)}s(void 0)}))}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}var l=function(){function e(){u(this,e)}var t,n;return p(e,[{key:"getAsync",value:function(e){e.type="get",this.ajax(e)}},{key:"postAsync",value:function(e){e.type="post",this.ajax(e)}},{key:"get",value:(n=c(regeneratorRuntime.mark((function e(t){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.type="get","application/json"===t.contentType&&("String"===this.typeOf(t.data)||(n=t.data,t.data=JSON.stringify(n))),e.abrupt("return",new Promise((function(e){t.success=function(t){e({success:!0,data:t})},t.error=function(t){e({success:!1,cause:"error",error:t})},t.timeout=function(t){e({success:!1,cause:"timeout",error:t})},r.ajax(t)})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"post",value:(t=c(regeneratorRuntime.mark((function e(t){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.type="post","application/json"===t.contentType&&("String"===this.typeOf(t.data)||(n=t.data,t.data=JSON.stringify(n))),e.abrupt("return",new Promise((function(e){t.success=function(t){e({success:!0,data:t})},t.error=function(t){e({success:!1,cause:"error",error:t})},t.timeout=function(t){e({success:!1,cause:"timeout",error:t})},r.ajax(t)})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"ajax",value:function(e){var t=this._createUrl(e),n=e.type,r=e.dataType,o=e.data,a=e.headers,s=e.contentType,i=null;if(!t)throw Error("Please specify url.");if("post"===n&&(i=o,"jsonp"===r))throw new Error("type:'POST' and 'dataType:jsonp' are specified together.\n                'POST' and 'jsonp' can not be specified together");if(a&&"jsonp"===r)throw new Error("'headers' and 'dataType:jsonp' can not be specified together.\n           Http headers cannot be sent when using jsonp.");var c={url:t,method:n,body:i,contentType:s};if(a&&(c.headers=a),"json"===r||"text"===r)return this._handleData(c,r,e);if("jsonp"===r)return this._handleJsonp(c,e);throw new Error("Please check dataType:".concat(r," dataType must be 'json' or 'jsonp'"))}},{key:"_getFetchParam",value:function(e){var t={method:e.method.toUpperCase(),mode:"cors",cache:"no-cache",headers:{}};if(!e.contentType)throw Error("Please specify contentType.");if(t.headers["Content-Type"]=e.contentType,e.credentials&&(t.credentials=e.credentials),e.headers)for(var n in e.headers){var r=e.headers[n];t.headers[n]=r}return e.body&&(t.body=e.body),t}},{key:"_handleData",value:function(e,t,n){var r=new d,o=this._getFetchParam(e);return function(e,n){return new Promise((function(r,o){n&&n.timeoutMillis&&setTimeout((function(){o("timeout")}),n.timeoutMillis),e.then((function(e){if(!e.ok){var n=e.statusText;o({data:n,response:e})}"json"===t&&e.json().then((function(t){r({data:t,response:e})})),"text"===t&&e.text().then((function(t){r({data:t,response:e})}))})).catch((function(e){o(e)}))}))}(fetch(e.url,o),n).then((function(e){r._success(e.data),n&&n.success&&n.success(e.data,e.response)})).catch((function(e){var t=e;r._fail(t),"timeout"===e?n&&n.timeout&&n.timeout():n&&n.error&&n.error(e,e.response)})),r}},{key:"_handleJsonp",value:function(e,t){var n=new d,r=document.createElement("script"),o="ajaxclient2_".concat(this._createUUID()),a=e.url;return a.indexOf("?")>=0?a+="&callback=".concat(o):a+="?callback=".concat(o),r.src=a,r.addEventListener("error",(function(e){n._fail(e),t&&t.error&&t.error(e,null)})),window[o]=function(e){delete window[o],n._success(e),t&&t.success&&t.success(e,null)},(document.getElementsByTagName("head")?document.getElementsByTagName("head")[0]:document.body).appendChild(r),n}},{key:"_createUrl",value:function(e){if("post"===e.type)return e.url;if("get"===e.type){var t=e.url;if(e.data){var n=JSON.parse(e.data);t+="?";for(var r=0,o=Object.keys(n);r<o.length;r++){var a=o[r],s=n[a];t+="".concat(a,"=").concat(s,"&")}t=t.substring(0,t.length-1)}return t}throw Error("Invalid type ".concat(e.type," is not supported"))}},{key:"_createUUID",value:function(){var e=(new Date).getTime();return"xxxxxxxx_xxxx_4xxx_yxxx_xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return("x"==t?n:3&n|8).toString(16)}))}},{key:"typeOf",value:function(e){return Object.prototype.toString.call(e).slice(8,-1)}}]),e}(),d=function(){function e(){u(this,e),this._successFunc=function(){},this._failFunc=function(){}}return p(e,[{key:"done",value:function(e){return this._successFunc=e,this}},{key:"fail",value:function(e){return this._failFunc=e,this}},{key:"_success",value:function(e){this._successFunc&&this._successFunc(e)}},{key:"_fail",value:function(e){this._failFunc&&this._failFunc(e)}}]),e}()}])}));